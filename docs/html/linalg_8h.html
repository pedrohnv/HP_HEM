<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>HP-HEM: src/linalg.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">HP-HEM
   &#160;<span id="projectnumber">1.0.2</span>
   </div>
   <div id="projectbrief">High Performance implementation of the Hybrid Electromagnetic Model</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">linalg.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;complex.h&gt;</code><br />
<code>#include &lt;string.h&gt;</code><br />
<code>#include &quot;<a class="el" href="electrode_8h_source.html">electrode.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="blas_8h_source.html">blas.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="lapack_8h_source.html">lapack.h</a>&quot;</code><br />
</div>
<p><a href="linalg_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a78e16120d4f849f427f158b09d902e7b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="linalg_8h.html#a78e16120d4f849f427f158b09d902e7b">fill_incidence_imm</a> (_Complex double *wg, const <a class="el" href="structElectrode.html">Electrode</a> *electrodes, size_t num_electrodes, const double *nodes, size_t num_nodes)</td></tr>
<tr class="separator:a78e16120d4f849f427f158b09d902e7b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a33642c7003a4cd4b48bff3fc9d3dc62d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="linalg_8h.html#a33642c7003a4cd4b48bff3fc9d3dc62d">fill_impedance_imm</a> (_Complex double *wg, const _Complex double *zl, const _Complex double *zt, size_t num_electrodes, size_t num_nodes)</td></tr>
<tr class="separator:a33642c7003a4cd4b48bff3fc9d3dc62d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad75ae4d39f97a3698d203ee8d21ce8a7"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="linalg_8h.html#ad75ae4d39f97a3698d203ee8d21ce8a7">solve_immittance</a> (_Complex double *wg, _Complex double *ie, size_t num_electrodes, size_t num_nodes)</td></tr>
<tr class="separator:ad75ae4d39f97a3698d203ee8d21ce8a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaa9c946ae5a9869ab887d16c3a53663a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="linalg_8h.html#aaa9c946ae5a9869ab887d16c3a53663a">fill_incidence_adm</a> (_Complex double *a, _Complex double *b, const <a class="el" href="structElectrode.html">Electrode</a> *electrodes, size_t num_electrodes, const double *nodes, size_t num_nodes)</td></tr>
<tr class="separator:aaa9c946ae5a9869ab887d16c3a53663a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5f5891e33ac5409304e03a98e1dc8e2c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="linalg_8h.html#a5f5891e33ac5409304e03a98e1dc8e2c">fill_impedance_adm</a> (_Complex double *yn, _Complex double *zl, _Complex double *zt, _Complex double *a, _Complex double *b, size_t num_electrodes, size_t num_nodes)</td></tr>
<tr class="separator:a5f5891e33ac5409304e03a98e1dc8e2c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7d630e8972ff9082b4ec50cfbe414b25"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="linalg_8h.html#a7d630e8972ff9082b4ec50cfbe414b25">calculate_yla_ytb</a> (_Complex double *yla, _Complex double *ytb, _Complex double *zl, _Complex double *zt, _Complex double *a, _Complex double *b, size_t num_electrodes, size_t num_nodes)</td></tr>
<tr class="separator:a7d630e8972ff9082b4ec50cfbe414b25"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a54c57fe27396e5a6c83997f8b5a361aa"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="linalg_8h.html#a54c57fe27396e5a6c83997f8b5a361aa">fill_impedance_adm2</a> (_Complex double *yn, _Complex double *yla, _Complex double *ytb, _Complex double *a, _Complex double *b, size_t num_electrodes, size_t num_nodes)</td></tr>
<tr class="separator:a54c57fe27396e5a6c83997f8b5a361aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a746119827db62bc550d181d4f2eb3f56"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="linalg_8h.html#a746119827db62bc550d181d4f2eb3f56">solve_admittance</a> (_Complex double *yn, _Complex double *ic, size_t num_nodes)</td></tr>
<tr class="separator:a746119827db62bc550d181d4f2eb3f56"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="a7d630e8972ff9082b4ec50cfbe414b25"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7d630e8972ff9082b4ec50cfbe414b25">&#9670;&nbsp;</a></span>calculate_yla_ytb()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int calculate_yla_ytb </td>
          <td>(</td>
          <td class="paramtype">_Complex double *&#160;</td>
          <td class="paramname"><em>yla</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">_Complex double *&#160;</td>
          <td class="paramname"><em>ytb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">_Complex double *&#160;</td>
          <td class="paramname"><em>zl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">_Complex double *&#160;</td>
          <td class="paramname"><em>zt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">_Complex double *&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">_Complex double *&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>num_electrodes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>num_nodes</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Calculates the modified longitudinal and transversal admittances \( Z_L^{-1} A \) and \( Z_T^{-1} B \). \( Z_L \) and \( Z_T \) are replaced by their inverses in the process. Useful when they are needed to calculate the currents \( I_L = Z_L^{-1} A U \) and \( I_T = Z_T^{-1} B U \). </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">yla</td><td>modified longitudinal admittance \( Z_L^{-1} A \) of size \( m \times n \) </td></tr>
    <tr><td class="paramname">ytb</td><td>modified transversal admittance \( Z_T^{-1} B \) of size \( m \times n \) </td></tr>
    <tr><td class="paramname">a</td><td>longitudinal incidence matrix \( A \) as flat array of size \( m \times n \) in COLUMN MAJOR ordering </td></tr>
    <tr><td class="paramname">b</td><td>transversal incidence matrix \( B \) as flat array of size \( m \times n \) in COLUMN MAJOR ordering </td></tr>
    <tr><td class="paramname">zl</td><td>longitudinal impedance matrix \( Z_L \) as a flat array of size \( m^2 \) </td></tr>
    <tr><td class="paramname">zt</td><td>transversal impedance matrix \( Z_T \) as a flat array of size \( m^2 \) </td></tr>
    <tr><td class="paramname">num_electrodes</td><td>number of electrodes \( m \) </td></tr>
    <tr><td class="paramname">num_nodes</td><td>number of nodes \( n \) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success </dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="linalg_8h.html#a54c57fe27396e5a6c83997f8b5a361aa">fill_impedance_adm2</a> </dd></dl>

</div>
</div>
<a id="a5f5891e33ac5409304e03a98e1dc8e2c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5f5891e33ac5409304e03a98e1dc8e2c">&#9670;&nbsp;</a></span>fill_impedance_adm()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int fill_impedance_adm </td>
          <td>(</td>
          <td class="paramtype">_Complex double *&#160;</td>
          <td class="paramname"><em>yn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">_Complex double *&#160;</td>
          <td class="paramname"><em>zl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">_Complex double *&#160;</td>
          <td class="paramname"><em>zt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">_Complex double *&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">_Complex double *&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>num_electrodes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>num_nodes</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Calculates the nodal admittance matrix \( Y_N = A^T Z_L^{-1} A + B^T Z_T^{-1} B \). As it is symmetric, only its lower half is stored (set). </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">yn</td><td>nodal admmitance matrix \( Y_N \) as flat array of size \( n^2 \) </td></tr>
    <tr><td class="paramname">a</td><td>longitudinal incidence matrix \( A \) as flat array of size \( m \times n \) in COLUMN MAJOR ordering </td></tr>
    <tr><td class="paramname">b</td><td>transversal incidence matrix \( B \) as flat array of size \( m \times n \) in COLUMN MAJOR ordering </td></tr>
    <tr><td class="paramname">zl</td><td>longitudinal impedance matrix \( Z_L \) as a flat array of size \( m^2 \) </td></tr>
    <tr><td class="paramname">zt</td><td>transversal impedance matrix \( Z_T \) as a flat array of size \( m^2 \) </td></tr>
    <tr><td class="paramname">num_electrodes</td><td>number of electrodes \( m \) </td></tr>
    <tr><td class="paramname">num_nodes</td><td>number of nodes \( n \) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success </dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="linalg_8h.html#a54c57fe27396e5a6c83997f8b5a361aa">fill_impedance_adm2</a> </dd>
<dd>
<a class="el" href="linalg_8h.html#a746119827db62bc550d181d4f2eb3f56">solve_admittance</a> </dd></dl>

</div>
</div>
<a id="a54c57fe27396e5a6c83997f8b5a361aa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a54c57fe27396e5a6c83997f8b5a361aa">&#9670;&nbsp;</a></span>fill_impedance_adm2()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int fill_impedance_adm2 </td>
          <td>(</td>
          <td class="paramtype">_Complex double *&#160;</td>
          <td class="paramname"><em>yn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">_Complex double *&#160;</td>
          <td class="paramname"><em>yla</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">_Complex double *&#160;</td>
          <td class="paramname"><em>ytb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">_Complex double *&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">_Complex double *&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>num_electrodes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>num_nodes</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Calculates the nodal admittance matrix \( Y_N = A^T Z_L^{-1} A + B^T Z_T^{-1} B \), were \( Z_L^{-1} A \) and \( Z_T^{-1} B \) are already calculated. Those matrices are preserved. Useful when they must be calculated to find the currents \( I_L = Z_L^{-1} A U \) and \( I_T = Z_T^{-1} B U \). </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">yn</td><td>nodal admmitance matrix \( Y_N \) as flat array of size \( n^2 \) </td></tr>
    <tr><td class="paramname">a</td><td>longitudinal incidence matrix \( A \) as flat array of size \( m \times n \) in COLUMN MAJOR ordering </td></tr>
    <tr><td class="paramname">b</td><td>transversal incidence matrix \( B \) as flat array of size \( m \times n \) in COLUMN MAJOR ordering </td></tr>
    <tr><td class="paramname">yla</td><td>modified longitudinal admittance \( Z_L^{-1} A \) </td></tr>
    <tr><td class="paramname">ytb</td><td>modified transversal admittance \( Z_T^{-1} B \) </td></tr>
    <tr><td class="paramname">num_electrodes</td><td>number of electrodes \( m \) </td></tr>
    <tr><td class="paramname">num_nodes</td><td>number of nodes \( n \) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success </dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="linalg_8h.html#a5f5891e33ac5409304e03a98e1dc8e2c">fill_impedance_adm</a> </dd>
<dd>
calculate_yla_ylb </dd>
<dd>
<a class="el" href="linalg_8h.html#a746119827db62bc550d181d4f2eb3f56">solve_admittance</a> </dd></dl>

</div>
</div>
<a id="a33642c7003a4cd4b48bff3fc9d3dc62d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a33642c7003a4cd4b48bff3fc9d3dc62d">&#9670;&nbsp;</a></span>fill_impedance_imm()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int fill_impedance_imm </td>
          <td>(</td>
          <td class="paramtype">_Complex double *&#160;</td>
          <td class="paramname"><em>wg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const _Complex double *&#160;</td>
          <td class="paramname"><em>zl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const _Complex double *&#160;</td>
          <td class="paramname"><em>zt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>num_electrodes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>num_nodes</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Fills the Global Immittance matrix \( W_G = \begin{bmatrix} Y_E &amp; A^T &amp; B^T \\ A &amp; -Z_L &amp; 0 \\ B &amp; 0 &amp; -Z_T \end{bmatrix} \) with the impedance matrices \( Z_L,Z_T \). As it is symmetric, only its lower half is stored (set). </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">wg</td><td>Global Immittance matrix as flat array of size \( (2m + n)^2 \) </td></tr>
    <tr><td class="paramname">zl</td><td>longitudinal impedance matrix \( Z_L \) as a flat array of size \( m^2 \) </td></tr>
    <tr><td class="paramname">zt</td><td>transversal impedance matrix \( Z_T \) as a flat array of size \( m^2 \) </td></tr>
    <tr><td class="paramname">num_electrodes</td><td>number of electrodes \( m \) </td></tr>
    <tr><td class="paramname">num_nodes</td><td>number of nodes \( n \) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success </dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="linalg_8h.html#a78e16120d4f849f427f158b09d902e7b">fill_incidence_imm</a> </dd>
<dd>
<a class="el" href="linalg_8h.html#ad75ae4d39f97a3698d203ee8d21ce8a7">solve_immittance</a> </dd></dl>

</div>
</div>
<a id="aaa9c946ae5a9869ab887d16c3a53663a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaa9c946ae5a9869ab887d16c3a53663a">&#9670;&nbsp;</a></span>fill_incidence_adm()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int fill_incidence_adm </td>
          <td>(</td>
          <td class="paramtype">_Complex double *&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">_Complex double *&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structElectrode.html">Electrode</a> *&#160;</td>
          <td class="paramname"><em>electrodes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>num_electrodes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&#160;</td>
          <td class="paramname"><em>nodes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>num_nodes</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Fills the nodal incidence matrices \( A \) and \( B \) used in the calculation of the nodal admittance matrix \( Y_N = A^T Z_L^{-1} A + B^T Z_T^{-1} B \).<br />
Note that \( B = |A|/2 \) and if it is desired to save memory, A and B can be set to be the same pointer and, in that case, it is guaranteed that the end result will be \( A \). In other words: when only \( A \) is desired, \( B \) can point to \( A, (B := A)\), saving memory space. Then call the function as: <code>fill_incidence_adm(a, a, electrodes, m, nodes, n);</code> so that \( a:=A \). </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">a</td><td>longitudinal incidence matrix \( A \) as flat array of size \( m \times n \) in COLUMN MAJOR ordering </td></tr>
    <tr><td class="paramname">b</td><td>transversal incidence matrix \( B \) as flat array of size \( m \times n \) in COLUMN MAJOR ordering </td></tr>
    <tr><td class="paramname">electrodes</td><td>array of electrodes </td></tr>
    <tr><td class="paramname">num_electrodes</td><td>number of electrodes \( m \) </td></tr>
    <tr><td class="paramname">nodes</td><td>array of nodes </td></tr>
    <tr><td class="paramname">num_nodes</td><td>number of nodes \( n \) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success </dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="linalg_8h.html#a5f5891e33ac5409304e03a98e1dc8e2c">fill_impedance_adm</a> </dd>
<dd>
<a class="el" href="linalg_8h.html#a54c57fe27396e5a6c83997f8b5a361aa">fill_impedance_adm2</a> </dd></dl>

</div>
</div>
<a id="a78e16120d4f849f427f158b09d902e7b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a78e16120d4f849f427f158b09d902e7b">&#9670;&nbsp;</a></span>fill_incidence_imm()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int fill_incidence_imm </td>
          <td>(</td>
          <td class="paramtype">_Complex double *&#160;</td>
          <td class="paramname"><em>wg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structElectrode.html">Electrode</a> *&#160;</td>
          <td class="paramname"><em>electrodes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>num_electrodes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&#160;</td>
          <td class="paramname"><em>nodes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>num_nodes</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Fills the Global Immittance matrix \( W_G = \begin{bmatrix} Y_E &amp; A^T &amp; B^T \\ A &amp; -Z_L &amp; 0 \\ B &amp; 0 &amp; -Z_T \end{bmatrix} \) with the incidence matrices \( A,B \). This function is separated from fill_impedance because \( A,B \) depend only on geometry, while \( Z_L,Z_T \) will vary with frequency. It is expected that \( W_G \) was zero-ed before calling this function (or allocated through calloc). As \( W_G \) is symmetric, only its lower half is stored (set). </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">wg</td><td>Global Immittance matrix \( W_G \) as flat array of size \( (2m + n)^2 \) </td></tr>
    <tr><td class="paramname">electrodes</td><td>array of electrodes </td></tr>
    <tr><td class="paramname">num_electrodes</td><td>number of electrodes \( m \) </td></tr>
    <tr><td class="paramname">nodes</td><td>array of nodes </td></tr>
    <tr><td class="paramname">num_nodes</td><td>number of nodes \( n \) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success </dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="linalg_8h.html#a33642c7003a4cd4b48bff3fc9d3dc62d">fill_impedance_imm</a> </dd>
<dd>
<a class="el" href="linalg_8h.html#ad75ae4d39f97a3698d203ee8d21ce8a7">solve_immittance</a> </dd></dl>

</div>
</div>
<a id="a746119827db62bc550d181d4f2eb3f56"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a746119827db62bc550d181d4f2eb3f56">&#9670;&nbsp;</a></span>solve_admittance()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int solve_admittance </td>
          <td>(</td>
          <td class="paramtype">_Complex double *&#160;</td>
          <td class="paramname"><em>yn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">_Complex double *&#160;</td>
          <td class="paramname"><em>ic</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>num_nodes</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Solves the system of equations of the Nodal Admitance formulation \( Y_N U = I_E \). It is recommended to use the raw LAPACK routines instead of this function. That way, the same system can be used to solve multiple right hand sides (injection vectors), the optimal workspace can be queried just once when solving for multiple frequencies. See the source code of this function to have an idea. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">yn</td><td>nodal admittance matrix \( Y_N = A^T Z_L^{-1} A + B^T Z_T^{-1} B \), assumed to be symmetric with lower half stored. The LU decomposition is done in-place. </td></tr>
    <tr><td class="paramname">ie</td><td>RHS vector of injected currents in each node. The solution replaces this array in-place. </td></tr>
    <tr><td class="paramname">num_electrodes</td><td>number of electrodes \( m \) </td></tr>
    <tr><td class="paramname">num_nodes</td><td>number of nodes \( n \) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on sucess </dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="linalg_8h.html#aaa9c946ae5a9869ab887d16c3a53663a">fill_incidence_adm</a> </dd>
<dd>
<a class="el" href="linalg_8h.html#a5f5891e33ac5409304e03a98e1dc8e2c">fill_impedance_adm</a> </dd>
<dd>
<a class="el" href="linalg_8h.html#a54c57fe27396e5a6c83997f8b5a361aa">fill_impedance_adm2</a> </dd></dl>

</div>
</div>
<a id="ad75ae4d39f97a3698d203ee8d21ce8a7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad75ae4d39f97a3698d203ee8d21ce8a7">&#9670;&nbsp;</a></span>solve_immittance()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int solve_immittance </td>
          <td>(</td>
          <td class="paramtype">_Complex double *&#160;</td>
          <td class="paramname"><em>wg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">_Complex double *&#160;</td>
          <td class="paramname"><em>ie</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>num_electrodes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>num_nodes</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Solves the system of equations of the Global Immitance formulation. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">wg</td><td>global immittance matrix \( W_G \), assumed to be symmetric with lower half stored. The LU decomposition is done in-place. </td></tr>
    <tr><td class="paramname">ie</td><td>RHS vector \([I_E, 0, 0]^T\) where \( I_E \) are injected currents in each node and 0 are null vectors of size \( m \) each. The solution replaces this array in-place becoming \( [U, I_L, I_T] \). Where \( U \) is the nodal potentials and \( I_L \) and \( I_T \) the longitudinal and transversal currents, respectively. It is recommended to use the raw LAPACK routines instead of this function. That way, the same system can be used to solve multiple right hand sides (injection vectors), the optimal workspace can be queried just once when solving for multiple frequencies. See the source code of this function to have an idea. </td></tr>
    <tr><td class="paramname">num_electrodes</td><td>number of electrodes \( m \) </td></tr>
    <tr><td class="paramname">num_nodes</td><td>number of nodes \( n \) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on sucess </dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="linalg_8h.html#a78e16120d4f849f427f158b09d902e7b">fill_incidence_imm</a> </dd>
<dd>
<a class="el" href="linalg_8h.html#a33642c7003a4cd4b48bff3fc9d3dc62d">fill_impedance_imm</a> </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.15
</small></address>
</body>
</html>
